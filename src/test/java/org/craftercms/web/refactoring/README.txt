Warning: This is a work in progress. The CS UI handlers are not fully implemented yet, nor the test refactoring!
Estimated progress: 33%